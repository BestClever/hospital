<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>药品登记</title>
    <link rel="stylesheet" th:href="@{/layui/css/layui.css}" media="all"/>
    <style>
        #dataFrm{
            margin: -75px 0px 0px 500px;
        }
        .dataFrm_input{
            font-size: 16px;
            width: 150px;
            height: 20px;
            margin-right: 20px;
            margin-bottom: 8px;
        }
        .dataFrm_td{
            display: block;
            width: 80px;
            text-align: right;
        }
        #add{
            margin: 0px;
        }
    </style>
</head>
<body>
<!-- 搜索条件开始 -->
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
    <legend>查询条件</legend>
</fieldset>
<form class="layui-form" method="post" id="searchFrm">
    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">住院号:</label>
            <div class="layui-input-inline">
                <input type="text" id="shows" autocomplete="off" class="layui-input" style="width:200px" >
            </div>
        </div>
        <div class="layui-inline" style="position: absolute;left: 340px;top:66px;">
            <div class="layui-input-inline">
                <button type="button" class="layui-btn layui-btn-normal  layui-icon layui-icon-search" id="doSearch">查询</button>
            </div>
        </div>
    </div>
</form>
<form class="layui-form"  lay-filter="dataFrm" id="dataFrm">
    <input type="hidden" id="show" name="registerid">
    <input type="hidden" id="hidden" name="moneys" value="0">
    <table>
        <tr>
            <td class="dataFrm_td">姓名：</td>
            <td><input type="text" id="ceshi" class="dataFrm_input" name="userName" disabled="disabled"></td>
            <td class="dataFrm_td">科室：</td>
            <td><input type="text" class="dataFrm_input" name="department" disabled="disabled"></td>
            <td class="dataFrm_td">预交金：</td>
            <td><input type="text" class="dataFrm_input" name="money" disabled="disabled"></td>
        </tr>
        <tr>
            <td class="dataFrm_td">性别：</td>
            <td><input type="text" class="dataFrm_input" name="sex" disabled="disabled"></td>
            <td class="dataFrm_td">医生：</td>
            <td><input type="text" class="dataFrm_input" name="doctorName" disabled="disabled"></td>
            <td class="dataFrm_td">已用：</td>
            <td><input type="text" class="dataFrm_input" disabled="disabled"></td>
        </tr>
        <tr>
            <td class="dataFrm_td">年龄：</td>
            <td><input type="text" class="dataFrm_input" name="age" disabled="disabled"></td>
            <td class="dataFrm_td">床位：</td>
            <td><input type="text" class="dataFrm_input" name="bedName" disabled="disabled"></td>
            <td class="dataFrm_td">余款：</td>
            <td><input type="text" class="dataFrm_input" disabled="disabled"></td>
        </tr>
    </table>
</form>
<!-- 数据表格开始 -->
<div  style="display: none;" id="ToolBar">
    <select name="supplierName" id="warehouseId" lay-verify="required" lay-filter="warehouse">
        <option value=""></option>
    </select>
</div>
<div style="display: block;width: 50%;">
    <table class="layui-hide" id="drugs" lay-filter="drugs"></table>
</div>
    <table class="layui-hide" id="drug" lay-filter="drug"></table>
<!-- 数据表格结束 -->
<script th:src="@{/layui/layui.js}"></script>
<script type="text/javascript" th:inline="none">
    var tableIns;
    layui.use([ 'jquery', 'layer', 'form', 'table'  ], function() {
        var $ = layui.jquery;
        var layer = layui.layer;
        var form = layui.form;
        var table = layui.table;
        var laydate = layui.laydate;
        //渲染数据表格
        tableIns=table.render({
            elem: '#drugs'   //渲染的目标对象
            ,url:'../liao/selPays' //数据接口
            ,title: '用户数据表'//数据导出来的标题
            ,toolbar:"#ToolBar"   //表格的工具条
            ,height:'full-200'
            ,page: 1  //是否启用分页, limits: [10, 20, 30]
            ,limits: [7, 20, 30]
            ,limit: 7//默认采用3
            ,cols: [[   //列表数据
                {field:'registerid', title:'住院号',align:'center',width:'25%'}
                ,{field:'userName', title:'姓名',align:'center',width:'25%'}
                ,{field:'money', title:'预交金额',align:'center',width:'25%'}
                ,{field:'payDate', title:'交款时间', templet: "<div>{{layui.util.toDateString(d.payDate, 'yyyy年MM月dd日 HH:mm:ss')}}</div>",align:'center',width:'25%'}
            ]]
        })
        //查询
        $("#doSearch").click(function(){
            if($("#shows").val()==""){
                alert("请输入住院号！");
                $("#shows").select();
                return false;
            }
            sel();
        });
        //失焦事件
        $("#shows").blur(function(){
            $("#dataFrm")[0].reset();
            $("#show").val($(this).val());
        });
        function sel(){
            var params=$("#dataFrm").serialize();
            $.ajax({
                url: '../liao/selPay',
                dataType: 'json',
                type: 'post',
                data:params,
                success: function (data) {
                    if(data==""){
                        alert("请输入正确的住院号！");
                        $("shows").select();
                    }
                    $.each(data, function (index, item) {
                        for(var i in item){
                            $("input[name="+i+"]").val(item[i])
                        }
                    });
                }
            })
        }
        $.ajax({
            url: '../liao/selSupplier',
            dataType: 'json',
            type: 'post',
            success: function (data) {
                $.each(data, function (index, item) {
                    alert(item.supplierName+"+"+item.warehouseId);
                    $('#warehouseId').append(new Option(item.warehouseId, item.warehouseId));// 下拉菜单里添加元素
                });
                layui.form.render("select");//重新渲染 固定写法
            }
        })
    });
</script>
</body>
</html>